
////////////////////////////////////////////////////////////////////////////////
// В данный модуль вынесены методы подсистемы CRM, вызываемые из модулей типовых объектов. 
// Выносить можно только те методы, которые не вызывают стандартные методы типового модуля или обработчики форм. 
// Т.е. вызывают только те методы, что тоже вынесены из типового или не содержат таких вызовов.
// Для каждого объекта необходимо задать свою #Область с именем объекта и модуля, как он называется в метаданных.  
////////////////////////////////////////////////////////////////////////////////
#Область СлужебныйПрограммныйИнтерфейс



Процедура СправочникиПередЗаписью(Источник, Отказ) Экспорт
	
	Если Источник.ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	#Область Контрагенты
	
	Если ТипЗнч(Источник) = Тип("СправочникОбъект.Контрагенты") Тогда
		
		ИспользоватьПартнеровКакКонтрагентов = ПолучитьФункциональнуюОпцию("ИспользоватьПартнеровКакКонтрагентов");
		Если ИспользоватьПартнеровКакКонтрагентов Тогда
			
			ПартнерКонтрагента = Источник.Партнер;
			Если ПартнерКонтрагента.ЮрФизЛицо = Перечисления.КомпанияЧастноеЛицо.ЧастноеЛицо Тогда
				
				Если Не ПустаяСтрока(ПартнерКонтрагента.CRM_Имя + ПартнерКонтрагента.CRM_Фамилия + ПартнерКонтрагента.CRM_Отчество) Тогда
					
					ФИОПартнера = СокрЛП(ПартнерКонтрагента.CRM_Фамилия + " " + ПартнерКонтрагента.CRM_Имя + " " + ПартнерКонтрагента.CRM_Отчество);
					Если Источник.НаименованиеПолное <> ФИОПартнера Тогда
					
						Источник.НаименованиеПолное = ФИОПартнера;
						
					КонецЕсли;	
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;	
	
	#КонецОбласти
	
КонецПроцедуры




#КонецОбласти // СлужебныйПрограммныйИнтерфейс
