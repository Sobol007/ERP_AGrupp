
&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	ПриОткрытииНаСервере();
	
	Если Не ЗначениеЗаполнено(РасчетЦены_ВидСравнения) Тогда
		РасчетЦены_ВидСравнения = "Равно";
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(Остаток_ВидСравнения) Тогда
		Остаток_ВидСравнения = "Равно";
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(СУчетомФакторов_ВидСравнения) Тогда
		СУчетомФакторов_ВидСравнения = "Равно";
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(УстанавливаемаяЦена_ВидСравнения) Тогда
		УстанавливаемаяЦена_ВидСравнения = "Равно";
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(Отклонение_ВидСравнения) Тогда
		Отклонение_ВидСравнения = "Равно";
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура ПриОткрытииНаСервере()
	
	Если ЗначениеЗаполнено(СтруктураОтборов) Тогда
		
		ТабОтборов = СтруктураОтборов.Получить();
		
		ОбработатьВходящиеОтборы(ТабОтборов);
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ОК(Команда)
	
	Закрыть(ПодготовитьДанныеЗакрыти());

КонецПроцедуры

&НаСервере
Функция ПодготовитьДанныеЗакрыти()
	
	ТабЗнач = Новый ТаблицаЗначений;
	ТабЗнач.Колонки.Добавить("Имя");
	ТабЗнач.Колонки.Добавить("ВидСравнения");
	ТабЗнач.Колонки.Добавить("Значение");
	
	Если РасчетЦены_Использование Тогда
		НовСтр = ТабЗнач.Добавить();
		НовСтр.Имя = "ЦенаСУчетомСтратегии";
		НовСтр.ВидСравнения = РасчетЦены_ВидСравнения;
		НовСтр.Значение = РасчетЦены_Значение;
	КонецЕсли;
	
	Если Остаток_Использование Тогда
		НовСтр = ТабЗнач.Добавить();
		НовСтр.Имя = "Остаток";
		НовСтр.ВидСравнения = Остаток_ВидСравнения;
		НовСтр.Значение = Остаток_Значение;
	КонецЕсли;

	Если СУчетомФакторов_Использование Тогда
		НовСтр = ТабЗнач.Добавить();
		НовСтр.Имя = "ЦенаСУчетомФакторов";
		НовСтр.ВидСравнения = СУчетомФакторов_ВидСравнения;
		НовСтр.Значение = СУчетомФакторов_Значение;
	КонецЕсли;

	Если УстанавливаемаяЦена_Использование Тогда
		НовСтр = ТабЗнач.Добавить();
		НовСтр.Имя = "ВнешняяЦена";
		НовСтр.ВидСравнения = УстанавливаемаяЦена_ВидСравнения;
		НовСтр.Значение = УстанавливаемаяЦена_Значение;
	КонецЕсли;

	Если Отклонение_Использование Тогда
		НовСтр = ТабЗнач.Добавить();
		НовСтр.Имя = "Отклонение";
		НовСтр.ВидСравнения = Отклонение_ВидСравнения;
		НовСтр.Значение = Отклонение_Значение;
	КонецЕсли;
	
	СтруктураВозврата = Новый ХранилищеЗначения(ТабЗнач);
	
	Возврат СтруктураВозврата;
	
КонецФункции

&НаКлиенте
Процедура Отмена(Команда)
	
	 Закрыть(Неопределено);
	
КонецПроцедуры

&НаКлиенте
Процедура РасчетЦены_ВидСравненияПриИзменении(Элемент)
	
	РасчетЦены_Использование = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура РасчетЦены_ЗначениеПриИзменении(Элемент)
	
	РасчетЦены_Использование = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура Остаток_ВидСравненияПриИзменении(Элемент)
	
	
	Остаток_Использование = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура Остаток_ЗначениеПриИзменении(Элемент)
	
	Остаток_Использование = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура СУчетомФакторов_ВидСравненияПриИзменении(Элемент)
	
	
	СУчетомФакторов_Использование = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура СУчетомФакторов_ЗначениеПриИзменении(Элемент)
	
	СУчетомФакторов_Использование = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура УстанавливаемаяЦена_ВидСравненияПриИзменении(Элемент)
	
	УстанавливаемаяЦена_Использование = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура УстанавливаемаяЦена_ЗначениеПриИзменении(Элемент)
	
	УстанавливаемаяЦена_Использование = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура Отклонение_ВидСравненияПриИзменении(Элемент)
	
	Отклонение_Использование = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура Отклонение_ЗначениеПриИзменении(Элемент)
	
	Отклонение_Использование = Истина;
	
КонецПроцедуры

&НаСервере
Процедура ОбработатьВходящиеОтборы(ТабОтборов)
	
	Для Каждого ТекОтбор Из ТабОтборов Цикл
		
		Если ТекОтбор.Имя = "ЦенаСУчетомСтратегии" Тогда
			
			РасчетЦены_Использование = Истина;
			РасчетЦены_ВидСравнения = ТекОтбор.ВидСравнения;
			РасчетЦены_Значение = ТекОтбор.Значение;
			
		ИначеЕсли ТекОтбор.Имя = "Остаток" Тогда
			
			Остаток_Использование = Истина;
			Остаток_ВидСравнения = ТекОтбор.ВидСравнения;
			Остаток_Значение = ТекОтбор.Значение;
			
		ИначеЕсли ТекОтбор.Имя = "ЦенаСУчетомФакторов" Тогда
			
			СУчетомФакторов_Использование = Истина;
			СУчетомФакторов_ВидСравнения = ТекОтбор.ВидСравнения;
			СУчетомФакторов_Значение = ТекОтбор.Значение;
			
		ИначеЕсли ТекОтбор.Имя = "ВнешняяЦена" Тогда
			
			УстанавливаемаяЦена_Использование = Истина;
			УстанавливаемаяЦена_ВидСравнения = ТекОтбор.ВидСравнения;
			УстанавливаемаяЦена_Значение = ТекОтбор.Значение;
			
		ИначеЕсли ТекОтбор.Имя = "Отклонение" Тогда
			
			Отклонение_Использование = Истина;
			Отклонение_ВидСравнения = ТекОтбор.ВидСравнения;
			Отклонение_Значение = ТекОтбор.Значение;
			
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

