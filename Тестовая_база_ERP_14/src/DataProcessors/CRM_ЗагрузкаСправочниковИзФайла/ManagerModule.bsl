#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

Процедура ЗагрузитьФайлВТаблицу(ПараметрыВызоваСервера, АдресХранилища) Экспорт
	
	ИмяВременногоФайла = ПараметрыВызоваСервера.ИмяВременногоФайла;
	Если нРег(ПараметрыВызоваСервера.Расширение) = "xls" или нРег(ПараметрыВызоваСервера.Расширение) = "xlsx" Тогда
		ЗагруженныйШаблонСДанными = Новый ТабличныйДокумент;
		ЗагруженныйШаблонСДанными.Прочитать(ИмяВременногоФайла, СпособЧтенияЗначенийТабличногоДокумента.Значение);
	Иначе
		ЗагруженныйШаблонСДанными = Новый ТекстовыйДокумент;
		ЗагруженныйШаблонСДанными.Прочитать(ИмяВременногоФайла);
	КонецЕсли;
	
	АдресХранилища = ПоместитьВоВременноеХранилище(ЗагруженныйШаблонСДанными, АдресХранилища);
	
	ФайловаяСистема.УдалитьВременныйФайл(ИмяВременногоФайла);
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли
